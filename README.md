# wallet-service

## Особенности реализации проекта и используемые технологии

- Основная цель проекта изучит новые технологии и улучшить имеющиеся навыки.
- Данный проект совершенствовался в соответствии с заданиями. Каждое улучшение представлено в отдельной ветке: firstTask, secondTask, thirdTask, fourthTask, fifthTask
- Главная ветка: develop. В ней находится последняя версия приложения.

  - В данном проекте, мной были изучены такие технологии как: 
    - Spring Aop, aspectJ; 
    - Junit, mockito; 
    - Testcontainers; 
    - Mockmvc;
    - Liquibase;
    - Swagger -> SpringDoc (создание swagger при помощи аннотаций на контроллерах);
    - Lombock.

  - Также в проекте использовались следующие технологии:
    - Spring boot;
    - JDBC;
    - PostgreSQL;
    - Spring MVC;
    - Docker (Базы данных поднимаются в докер).



## Описание функционала:

### Операции с Пользователями

1. Создание пользователя:
   - Пользователь может быть создан при самостоятельной регистрации или администратором;
   - При создании пользователя, создаётся счёт пользователя.
2. Просмотр пользователей:
   - Пользователь может получить информацию о себе после авторизации;

### Операции с Транзакциями

1. Создание Транзакции:
   - Для создания транзакции пользователь должен пройти авторизацию и получить токен.
   - На данном этапе программы. Создание транзации подразумевает её проведение с изменением баланса счёта 
в соответствии с информацией в данной транзакции;
   - Id транзакции должен быть уникальным и задаётся пользователем.

2. Просмотр Транзакций:
   - Пользователь может получить историю транзакций.

### Операции со Счётом (Account)

1. Создание счёта:
   - На данный момент реализовано автоматическое создание счёта при регистрации пользователя.
2. Просмотр счёта:
   - доступен пользователю после авторизации.

### Аналитика и отчетность

1. Созданы отдельные стартеры для логирования и аудита (starter-aspect-logger, starter-aspect-audit)

#### starter-aspect-logger
- При добавлении зависимости данного стартера, 
он будет работать автоматически, если пометить нужные методы или классы аннотацией @Loggable;
- Логикой данного логгера подразумевается просмотр факта вызова метода и его совершения, а также длительности работы метода.

#### starter-aspect-audit
- При добавлении зависимости данного стартера, 
он будет работать только при добавлении в main class Spring boot проекта аннотации @EnableAspectAuditConfiguration, 
а также пометить необходимые классы или методы аннотацией @Auditable. На данном этапе реализации стартера, 
лучше применять его только к репозиторию в связи со спецификой его реализации.
- В приложении, которое использует данный стартер необходимо переопределить некоторые методы для возможности сохранения аудита в свою базу данных
- В приложении имеется возможность просмотра всех аудитов при помощи  get-запроса.

## Инструкция по запуску проекта

Для запуска проекта потребуется:
- java 17
- docker
- доступ в интернет (при необходимости)

1. Перед запуском программы, в корневой папке "shared-wallet-service" выполните команду "mvn clean install";
2. Перед запуском программы, в корневой папке "starter-aspect-logger" выполните команду "mvn clean install"
3. Перед запуском программы, в корневой папке "starter-aspect-audit" выполните команду "mvn clean install"
4. Перед запуском программы, в корневой папке "wallet-service" выполните команду "mvn compile" 
с целью подтянуть недостающие зависимости и не трогать тесты;
5. Запустите докер;
6. В корневой папке "wallet-service" выполните команду "docker-compose up"
для создания базы данных и pgadmin (на всякий случай);
7. Теперь можно выполнить команду "mvn clean package" в корневой папке "wallet-service";
8. Можно запустить программу при помощи файла: "/wallet-service/src/main/java/io/ylab/walletservice/WalletServiceApplication.java"
9. Без аутентификации у вас открыт доступ к swagger. При запущенной программе введите в адресную строку: http://localhost:8081/swagger-ui/index.html
Далее введите в поиске свагера: /v3/api-docs
10. Без аутентификации у вас открыт доступ к 2 операциям: регистрация и авторизация;
11. После аутентификации в headers скопируйте token и в постмане добавьте его в поле хедера "Authorization" - "Bearer token";
12. К проекту прикреплены коллекции для Postman в папке postmanCollections.

Порт приложения: 8081

Если необходим доступ к pgadmin:
1. введите в адресной строке localhost:888;
2. login: admin@admin.admin;
3. password: admin;
4. зарегистрируйте сервер:
- имея хоста: pg_db;
- порт: 5432;
- логин: ylab;
- пароль: ylab.

---
